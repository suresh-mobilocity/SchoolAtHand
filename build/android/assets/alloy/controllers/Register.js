function Controller(){function e(){s.registerForm.removeEventListener("close",e),s.registerForm.removeAllChildren(),h=null}function t(){0!=l()&&(h.open(),Cloud.Users.create({username:s.emailAddress.value,password:s.inputPassword.value,password_confirmation:s.confirmPassword.value,first_name:s.firstName.value,last_name:s.lastName.value,email:s.emailAddress.value},function(e){e.success?i(s.emailAddress.value,s.inputPassword.value):alert("Error:\n"+(e.error&&e.message||JSON.stringify(e)))}))}function i(e,t){CloudPush.retrieveDeviceToken({success:function(i){Ti.App.Properties.setString("ACSDeviceToken","e.deviceToken"),deviceToken=i.deviceToken,o(e,t)},error:function(e){alert("Failed to register for Push Notification"+e.error)}})}function o(e,t){Cloud.Users.login({login:e,password:t},function(e){if(e.success){var t=e.users[0];Ti.App.Properties.setString("ACS-StoredSessionId",Cloud.sessionId),n(),h.close(),Ti.App.Properties.setBool("LoggedIn",!0),Ti.App.Properties.setString("username",t.username),loginLabel="SignOut",s.registerForm.close()}else alert("Error:\n"+(e.error&&e.message||JSON.stringify(e)))})}function r(){CloudPush.showTrayNotification=!0,CloudPush.showTrayNotificationsWhenFocused=!0,CloudPush.focusAppOnPush=!1,CloudPush.showAppOnTrayClick=!0,CloudPush.addEventListener("callback",function(){}),CloudPush.addEventListener("trayClickLaunchedApp",function(){}),CloudPush.addEventListener("trayClickFocusedApp",function(){})}function n(){s.recivePushFromSBSD.value&&Cloud.PushNotifications.subscribeToken({device_token:deviceToken,channel:"SBSD_Alerts",type:"gcm"},function(e){e.success?r():alert("Error:\n"+(e.error&&e.message||JSON.stringify(e)))}),s.recivePushFromPTA.value&&Cloud.PushNotifications.subscribeToken({device_token:deviceToken,channel:"PTA_Alerts",type:"gcm"},function(e){e.success?r():alert("Error:\n"+(e.error&&e.message||JSON.stringify(e)))}),s.recivePushFromSports.value&&Cloud.PushNotifications.subscribeToken({device_token:deviceToken,channel:"Sports_Alerts",type:"gcm"},function(e){e.success?r():alert("Error:\n"+(e.error&&e.message||JSON.stringify(e)))})}function a(e){var t=e,i=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return testresults=i.test(t)?!0:!1}function l(){return""==s.firstName.value?(alert("Error:\nFirstname field empty"),!1):""==s.lastName.value?(alert("Error:\nLastname field empty"),!1):""==s.emailAddress.value||0==a(s.emailAddress.value)?(alert("Error:\nInvalid email is field empty"),!1):""==s.inputPassword.value?(alert("Error:\nPassword field empty"),!1):""==s.confirmPassword.value?(alert("Error:\nConfirm Password field empty"),!1):!0}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="Register",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var s=this,d={},c={};s.__views.registerForm=Ti.UI.createWindow({backgroundColor:"white",id:"registerForm",fullscreen:"false"}),s.__views.registerForm&&s.addTopLevelView(s.__views.registerForm),s.__views.registerView=Ti.UI.createScrollView({id:"registerView",layout:"vertical"}),s.__views.registerForm.add(s.__views.registerView),s.__views.firstName=Ti.UI.createTextField({top:40,left:20,width:"80%",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Titanium.UI.KEYBOARD_DEFAULT,returnKeyType:Titanium.UI.RETURNKEY_DONE,height:Ti.UI.SIZE,font:{fontSize:14,fontWeight:"bold",fontFamily:"Helvetica",fontStyle:"normal"},color:"black",hintText:"First Name",id:"firstName"}),s.__views.registerView.add(s.__views.firstName),s.__views.lastName=Ti.UI.createTextField({top:20,left:20,height:40,width:"80%",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Titanium.UI.KEYBOARD_DEFAULT,returnKeyType:Titanium.UI.RETURNKEY_DONE,font:{fontSize:14,fontWeight:"bold",fontFamily:"Helvetica",fontStyle:"normal"},color:"black",hintText:"Last Name",id:"lastName"}),s.__views.registerView.add(s.__views.lastName),s.__views.emailAddress=Ti.UI.createTextField({top:20,left:20,width:"80%",height:40,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Titanium.UI.KEYBOARD_DEFAULT,returnKeyType:Titanium.UI.RETURNKEY_DONE,font:{fontSize:14,fontWeight:"bold",fontFamily:"Helvetica",fontStyle:"normal"},color:"black",hintText:"Email Address",id:"emailAddress"}),s.__views.registerView.add(s.__views.emailAddress),s.__views.inputPassword=Ti.UI.createTextField({top:20,left:20,width:"80%",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Titanium.UI.KEYBOARD_DEFAULT,returnKeyType:Titanium.UI.RETURNKEY_DONE,height:40,font:{fontSize:14,fontWeight:"bold",fontFamily:"Helvetica",fontStyle:"normal"},color:"black",hintText:"Password min 4 characters",id:"inputPassword",passwordMask:"true"}),s.__views.registerView.add(s.__views.inputPassword),s.__views.confirmPassword=Ti.UI.createTextField({top:20,left:20,width:"80%",borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Titanium.UI.KEYBOARD_DEFAULT,returnKeyType:Titanium.UI.RETURNKEY_DONE,height:40,font:{fontSize:14,fontWeight:"bold",fontFamily:"Helvetica",fontStyle:"normal"},color:"black",hintText:"Confirm Password",id:"confirmPassword",passwordMask:"true"}),s.__views.registerView.add(s.__views.confirmPassword),s.__views.pushNotificationSelection=Ti.UI.createLabel({top:20,left:20,width:Ti.UI.SIZE,height:Ti.UI.SIZE,font:{fontSize:14,fontWeight:"normal",fontFamily:"Helvetica",fontStyle:"normal"},color:"blue",textAlign:Ti.UI.TEXT_ALIGNMENT_LEFT,text:"I agreee to reive push notifications for",id:"pushNotificationSelection"}),s.__views.registerView.add(s.__views.pushNotificationSelection),s.__views.__alloyId58=Ti.UI.createView({layout:"horizontal",height:Ti.UI.SIZE,id:"__alloyId58"}),s.__views.registerView.add(s.__views.__alloyId58),s.__views.__alloyId59=Ti.UI.createLabel({top:20,left:20,width:"70%",height:Ti.UI.SIZE,font:{fontSize:14,fontWeight:"normal",fontFamily:"Helvetica",fontStyle:"normal"},color:"blue",text:"School Announcements",id:"__alloyId59"}),s.__views.__alloyId58.add(s.__views.__alloyId59),s.__views.recivePushFromSBSD=Ti.UI.createSwitch({top:20,left:20,width:Ti.UI.SIZE,height:Ti.UI.SIZE,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,color:"blue",value:!0,style:Ti.UI.Android.SWITCH_STYLE_CHECKBOX,id:"recivePushFromSBSD"}),s.__views.__alloyId58.add(s.__views.recivePushFromSBSD),s.__views.__alloyId60=Ti.UI.createView({layout:"horizontal",height:Ti.UI.SIZE,id:"__alloyId60"}),s.__views.registerView.add(s.__views.__alloyId60),s.__views.__alloyId61=Ti.UI.createLabel({top:20,left:20,width:"70%",height:Ti.UI.SIZE,font:{fontSize:14,fontWeight:"normal",fontFamily:"Helvetica",fontStyle:"normal"},color:"blue",text:"PTA Annoncements",id:"__alloyId61"}),s.__views.__alloyId60.add(s.__views.__alloyId61),s.__views.recivePushFromPTA=Ti.UI.createSwitch({top:20,left:20,width:Ti.UI.SIZE,height:Ti.UI.SIZE,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,color:"blue",value:!0,style:Ti.UI.Android.SWITCH_STYLE_CHECKBOX,id:"recivePushFromPTA"}),s.__views.__alloyId60.add(s.__views.recivePushFromPTA),s.__views.__alloyId62=Ti.UI.createView({layout:"horizontal",height:Ti.UI.SIZE,id:"__alloyId62"}),s.__views.registerView.add(s.__views.__alloyId62),s.__views.__alloyId63=Ti.UI.createLabel({top:20,left:20,width:"70%",height:Ti.UI.SIZE,font:{fontSize:14,fontWeight:"normal",fontFamily:"Helvetica",fontStyle:"normal"},color:"blue",text:"Sports Anouncements",id:"__alloyId63"}),s.__views.__alloyId62.add(s.__views.__alloyId63),s.__views.recivePushFromSports=Ti.UI.createSwitch({top:20,left:20,width:Ti.UI.SIZE,height:Ti.UI.SIZE,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,color:"blue",value:!0,style:Ti.UI.Android.SWITCH_STYLE_CHECKBOX,id:"recivePushFromSports"}),s.__views.__alloyId62.add(s.__views.recivePushFromSports),s.__views.buttonRegister=Ti.UI.createButton({title:"Signup",backgroundColor:"#336699",top:20,left:"10%",width:"80%",height:Ti.UI.SIZE,font:{fontSize:12,fontWeight:"bold"},color:"white",borderRadius:10,id:"buttonRegister"}),s.__views.registerView.add(s.__views.buttonRegister),t?s.__views.buttonRegister.addEventListener("click",t):c["$.__views.buttonRegister!click!actionRegister"]=!0,s.__views.activityIndicator=Ti.UI.createActivityIndicator({id:"activityIndicator"}),s.__views.registerView.add(s.__views.activityIndicator),d.destroy=function(){},_.extend(s,s.__views);var u=arguments[0]||{};u.parentTab;var h=Alloy.createController("ProgressIndicator",{message:"Registering User .. \n"+s.emailAddress.value}).getView();s.registerForm.addEventListener("close",e),c["$.__views.buttonRegister!click!actionRegister"]&&s.__views.buttonRegister.addEventListener("click",t),_.extend(s,d)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;