function WPATH(e){var t=e.lastIndexOf("/"),i=-1===t?"com.appcelerator.drawer/"+e:e.substring(0,t)+"/com.appcelerator.drawer/"+e.substring(t+1);return 0!==i.indexOf("/")?"/"+i:i}function Controller(){function e(){i._isOpen=!i._isOpen,i.pulltab.backgroundImage="/images/com.appcelerator.drawer/"+(i._isOpen?"PullTabDown.png":"PullTabUp.png"),Ti.API.info((i._isOpen?"Opening":"Closing")+" the drawer (buttonbar="+(i._params.iconSize+2*i._params.gutter)+", drawer="+i.drawer.size.height+")"),i.pulltab.accessibilityValue=i._isOpen?"Open":"Closed",i.pulltab.accessibilityHint="Click to "+(i._isOpen?"close":"open")+" the drawer",i.drawer.animate({bottom:i._isOpen?0:-(i._params.iconSize+2*i._params.gutter),opacity:i._isOpen?i._params.openOpacity:i._params.closeOpacity,duration:i._params.animationDuration}),i._isOpen&&i._annoy&&clearInterval(i._annoy)}function t(e){var t=Array.prototype,i=t.slice,o=t.concat,r={},l=o.apply(t,i.call(arguments,1));for(var a in e)_.contains(l,a)||(r[a]=e[a]);return r}new(require("alloy/widget"))("com.appcelerator.drawer"),this.__widgetId="com.appcelerator.drawer",require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="widget",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var i=this,o={},r={};i.__views.drawer=Ti.UI.createView({left:0,right:0,bottom:-48,width:Ti.UI.FILL,height:64,layout:"vertical",opacity:.75,id:"drawer"}),i.__views.drawer&&i.addTopLevelView(i.__views.drawer),i.__views.pulltab=Ti.UI.createButton({backgroundImage:"/images/com.appcelerator.drawer/PullTabUp.png",center:{x:"50%"},top:0,width:48,height:16,accessibilityLabel:"Drawer",accessibilityValue:"Closed",accessibilityHint:"Click to open the drawer",id:"pulltab"}),i.__views.drawer.add(i.__views.pulltab),e?i.__views.pulltab.addEventListener("click",e):r["$.__views.pulltab!click!pullTabClick"]=!0,i.__views.buttonbar=Ti.UI.createView({left:0,top:0,width:Ti.UI.FILL,height:48,backgroundColor:"black",layout:"horizontal",id:"buttonbar"}),i.__views.drawer.add(i.__views.buttonbar),o.destroy=function(){},_.extend(i,i.__views);var l=16,a={autoClose:!1,iconSize:48,openOpacity:.9,closeOpacity:.75,animationDuration:500,gutter:0,overrideMenu:!1,annoy:0};i._isOpen=!1,i._buttons=[],i._params={},i._annoy=!1,o.jiggle=function(){if(!i._isOpen&&i._params.overrideMenu){var e=require("alloy/animation"),t=[Ti.UI.createAnimation({bottom:-(i._params.iconSize+2*i._params.gutter)+l,duration:250}),Ti.UI.createAnimation({bottom:-(i._params.iconSize+2*i._params.gutter)-l/2,duration:125}),Ti.UI.createAnimation({bottom:-(i._params.iconSize+2*i._params.gutter),duration:125})];e.chainAnimate(i.drawer,t)}},o.checkEnabled=function(){i._params.overrideMenu&&Object.keys(i._buttons).forEach(function(e){var t=parseInt(e,10);i._buttons[t].enabled&&(i._buttons[t].button.enabled=i._buttons[t].enabled())})},o.init=function(o){if(i._buttons=o.buttons,i._params=_.defaults(o,a),i._params.overrideMenu)i.buttonbar.height=i._params.iconSize+2*i._params.gutter,i.drawer.height=l+i.buttonbar.height,i.drawer.bottom=-i.buttonbar.height,Object.keys(i._buttons).forEach(function(o){var r=parseInt(o,10),l=t(i._buttons[r],["id","title","click","enabled"]);_.extend(l,{top:i._params.gutter,left:i._params.gutter,width:i._params.iconSize,height:i._params.iconSize,backgroundImage:"/images/"+i._buttons[r].id+"Enabled.png",backgroundDisabledImage:"/images/"+i._buttons[r].id+"Disabled.png"}),i._buttons[r].button=Ti.UI.createButton(l),i._buttons[r].button.addEventListener("click",function(t){i._buttons[r].click&&i._buttons[r].click(t),i._params.autoClose&&e(t)}),i.buttonbar.add(i._buttons[r].button)}),i._params.annoy&&(i._annoy=setInterval(function(){i._params.annoy>0&&i._params.annoy--,0===i._params.annoy&&clearInterval(i._annoy),i.jiggle()},2e3));else{i.drawer.visible=!1;var r=i._params.mainWindow.activity;r.onCreateOptionsMenu=function(e){var t=e.menu;Object.keys(i._buttons).forEach(function(e){var o=parseInt(e,10),r=t.add({title:i._buttons[o].title,itemId:o});r.setIcon("/images/"+i._buttons[o].id+"Enabled.png"),i._buttons[o].click&&r.addEventListener("click",i._buttons[o].click)})},r.onPrepareOptionsMenu=function(e){var t=e.menu;Object.keys(i._buttons).forEach(function(e){var o=parseInt(e,10),r=t.findItem(o);r.enabled=i._buttons[o].enabled?i._buttons[o].enabled():!0})}}},r["$.__views.pulltab!click!pullTabClick"]&&i.__views.pulltab.addEventListener("click",e),_.extend(i,o)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;